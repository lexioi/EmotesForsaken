-- === –ù–ê–°–¢–†–û–ô–ö–ê –ö–õ–Æ–ß–ê ===
local validKey = "Thanks4Join "
local linkToCopy = "https://discord.gg/jCrnRkuN" -- –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—É—é —Å—Å—ã–ª–∫—É

-- === –°–û–ó–î–ê–ù–ò–ï GUI –î–õ–Ø –ö–õ–Æ–ß–ê ===
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local keyGui = Instance.new("ScreenGui")
keyGui.Name = "KeySystemGui"
keyGui.ResetOnSpawn = false
keyGui.Parent = playerGui

local keyFrame = Instance.new("Frame")
keyFrame.Size = UDim2.new(0, 300, 0, 200)
keyFrame.Position = UDim2.new(0.5, -150, 0.5, -100)
keyFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
keyFrame.BackgroundTransparency = 0.5 -- –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å 0.4-0.6
keyFrame.BorderColor3 = Color3.fromRGB(255, 255, 255)
keyFrame.Parent = keyGui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 50)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundTransparency = 1
title.Text = "Key System"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 24
title.Parent = keyFrame

local textBox = Instance.new("TextBox")
textBox.Size = UDim2.new(0.8, 0, 0, 40)
textBox.Position = UDim2.new(0.1, 0, 0.35, 0)
textBox.PlaceholderText = "Enter your key..."
textBox.Text = ""
textBox.TextScaled = true
textBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
textBox.BorderColor3 = Color3.fromRGB(255, 255, 255)
textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
textBox.Parent = keyFrame

local copyButton = Instance.new("TextButton")
copyButton.Size = UDim2.new(0.45, -5, 0, 40)
copyButton.Position = UDim2.new(0.05, 0, 0.65, 0)
copyButton.Text = "Copy Link"
copyButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
copyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
copyButton.Font = Enum.Font.SourceSansBold
copyButton.TextSize = 18
copyButton.Parent = keyFrame

local submitButton = Instance.new("TextButton")
submitButton.Size = UDim2.new(0.45, -5, 0, 40)
submitButton.Position = UDim2.new(0.5, 5, 0.65, 0)
submitButton.Text = "Submit Key"
submitButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
submitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
submitButton.Font = Enum.Font.SourceSansBold
submitButton.TextSize = 18
submitButton.Parent = keyFrame

-- –¢–µ–∫—Å—Ç "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!" –ø–æ–¥ –∫–Ω–æ–ø–∫–æ–π Copy Link (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç)
local copiedLabel = Instance.new("TextLabel")
copiedLabel.Size = UDim2.new(0.45, -5, 0, 20)
copiedLabel.Position = UDim2.new(0.05, 0, 0.75, 0)
copiedLabel.BackgroundTransparency = 1
copiedLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
copiedLabel.Font = Enum.Font.SourceSansBold
copiedLabel.TextSize = 16
copiedLabel.Text = ""
copiedLabel.TextTransparency = 1 -- –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç
copiedLabel.Parent = keyFrame

-- === –§–£–ù–ö–¶–ò–Ø –ö–û–ü–ò–†–û–í–ê–ù–ò–Ø –°–°–´–õ–ö–ò ===
copyButton.Activated:Connect(function()
	setclipboard(linkToCopy)
	
	-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!" –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã
	copiedLabel.Text = "Copied!"
	copiedLabel.TextTransparency = 0
	wait(2)
	copiedLabel.TextTransparency = 1
end)

-- === –í–°–¢–ê–í–¨ –°–Æ–î–ê –ö–û–î scriptl.txt ===
local lexioiScript = [[
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local CollectionService = game:GetService("CollectionService")

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞ –∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–±—É–¥—É—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏)
local player = Players.LocalPlayer
print("DEBUG: LocalPlayer:", player.Name)

local character: Model? = nil
local humanoid: Humanoid? = nil
local originalJumpPower = 50

-- –†–µ—Å—É—Ä—Å—ã
local assetsFolder = ReplicatedStorage:WaitForChild("Assets")
local emotesFolder = assetsFolder:WaitForChild("Emotes")
-- –ü–∞–ø–∫–∞ Animations –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ ModuleScript'–æ–≤, –Ω–æ –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
local animationsFolder = assetsFolder:FindFirstChild("Animations") or Instance.new("Folder", assetsFolder)
animationsFolder.Name = "Animations" -- –°–æ–∑–¥–∞–µ–º –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏, –Ω–æ –æ–Ω–∞ –Ω–µ –±—É–¥–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ ModuleScripts

-- –í–°–¢–†–û–ï–ù–ù–´–ï –î–ê–ù–ù–´–ï –ê–ù–ò–ú–ê–¶–ò–ô –£–ë–ò–ô–¶
-- –í—Å–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–∞–º–∏ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–æ–±—Ä–∞–Ω—ã –∑–¥–µ—Å—å –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É.
local allKillerAnimations = {
    -- –ê–Ω–∏–º–∞—Ü–∏–∏ 1x1x1x1
    ["1x1x1x1"] = { -- –≠—Ç–æ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–∞–∫ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –≤ –º–µ–Ω—é
        ZombieAnimations = {
            Idle = "rbxassetid://138465378316476";
            Walk = "rbxassetid://127848783748209";
            Run = "rbxassetid://72722119435580";
            Attack = "rbxassetid://81362825527808";
            Summon = "rbxassetid://75804462760596";
        };
        Animations = {
            Idle = "rbxassetid://138754221537146";
            Walk = "rbxassetid://109130982296927";
            Run = "rbxassetid://106485518413331";
            Introduction = {
                KillerRig = "rbxassetid://90184955335084";
                CameraRig = "rbxassetid://81326704545708"; -- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
            };
            Execution = {
                KillerRig = "rbxassetid://93368339913846";
                PlayerRig = "rbxassetid://116471413261624";
            };
            ExecutionShedletsky = {
                KillerRig = "rbxassetid://123924093489218";
                PlayerRig = "rbxassetid://116039506373774";
            };
            BetterIdle = "rbxassetid://138754221537146";
            BetterWalk = "rbxassetid://131235528875091";
            BetterRun = "rbxassetid://89252407304675";
            Slash = "rbxassetid://83829782357897";
            Entanglement = "rbxassetid://119181003138006";
            UnstableEye = "rbxassetid://119429069577280";
            RejuvenateTheRotten = "rbxassetid://116996902830888";
            MassInfection = "rbxassetid://131430497821198";
            Stunned = {
                Start = "rbxassetid://96642629473615";
                Loop = "rbxassetid://131392439047269";
                End = "rbxassetid://121164654140845";
            };
            Victory = {
                KillerRig = "rbxassetid://137889266669216";
                CameraRig = "rbxassetid://129809576292762"; -- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
                ShedletskyRig = "rbxassetid://121740536645205";
            };
        };
    },
    -- –ê–Ω–∏–º–∞—Ü–∏–∏ c00lkidd
    ["c00lkidd"] = {
        PizzaDeliveryAnimations = {
            Summoned = "rbxassetid://18886065814";
            Idle = "rbxassetid://18886066950";
            Walk = "rbxassetid://18886064499";
            Hit = "rbxassetid://18886068630";
        };
        Animations = {
            Idle = "rbxassetid://18885903667";
            Walk = "rbxassetid://18885906143";
            Run = "rbxassetid://96571077893813";
            InjuredIdle = "rbxassetid://18885903667";
            InjuredWalk = "rbxassetid://18885906143";
            InjuredRun = "rbxassetid://96571077893813";
            Stunned = {
                Start = "rbxassetid://109869078763813";
                Loop = "rbxassetid://125337218572338";
                End = "rbxassetid://83635673319417";
            };
            Introduction = {
                KillerRig = "rbxassetid://18924919303";
                CameraRig = "rbxassetid://18925097303"; -- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
            };
            Victory = {
                KillerRig = "rbxassetid://108042935463999";
                KillerRigLoop = "rbxassetid://86524030996609";
                CameraRig = "rbxassetid://78439581321137"; -- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
            };
            Execution = {
                KillerRig = "rbxassetid://89669118763885";
                PlayerRig = "rbxassetid://78051806190478";
            };
            Execution007n7 = {
                KillerRig = "rbxassetid://133688616073016";
                PlayerRig = "rbxassetid://132293609857524";
            };
            Attack = "rbxassetid://18885909645";
            CorruptNature = "rbxassetid://18885919947";
            SummonPizzaDelivery = "rbxassetid://18885915433";
            WalkspeedOverrideStart = "rbxassetid://98456918873918";
            WalkspeedOverrideLoop = "rbxassetid://106776364623742";
            WalkspeedOverrideHit = "rbxassetid://18885937766";
            WalkspeedOverrideMiss = "rbxassetid://18885940850";
        };
    },
    -- –ê–Ω–∏–º–∞—Ü–∏–∏ Noli
    ["Noli"] = {
        Animations = {
            Idle = "rbxassetid://83465205704188";
            Walk = "rbxassetid://109700476007435";
            Run = "rbxassetid://117451341682452";
            InjuredIdle = "rbxassetid://83465205704188";
            InjuredWalk = "rbxassetid://109700476007435";
            InjuredRun = "rbxassetid://117451341682452";
            Stab = "rbxassetid://109230267448394";
            Victory = {
                KillerRig = "rbxassetid://89207009102595";
                CameraRig = "rbxassetid://92599409662127"; -- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
            };
            VoidRush = {
                StartCharge = "rbxassetid://91758760621955";
                LoopCharge = "rbxassetid://93841120533318";
                CancelCharge = "rbxassetid://91758760621955";
                StartDashInit = "rbxassetid://139835501033932";
                LoopDashInit = "rbxassetid://126896426760253";
                StartDashCombo = "rbxassetid://114356208094580";
                LoopDashCombo = "rbxassetid://135884061951801";
                EndDash = "rbxassetid://139321362207112";
                EndDashCrashed = "rbxassetid://94039555054855";
                EndDashNonChar = "rbxassetid://94039555054855";
                WeakHit = "rbxassetid://92243093913547";
                CutsceneKillerRig = "rbxassetid://81533966558979";
            };
            VoidRushVictimRig = "rbxassetid://134053005930385";
            NovaThrow = "rbxassetid://107339108383093";
            NovaDet = "rbxassetid://125504560920616";
            ObservantStart = "rbxassetid://113357690193035";
            ObservantLoop = "rbxassetid://104744456957363";
            ObservantTeleport = "rbxassetid://140042539182927";
            Hallucination = "rbxassetid://140042539182927";
            Introduction = {
                KillerRig = "rbxassetid://82002727792391";
                CameraRig = "rbxassetid://140061272138793"; -- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
            };
            Execution = {
                KillerRig = "rbxassetid://129491851057694";
                PlayerRig = "rbxassetid://116544958644813";
                PlayerCFrameOffset = CFrame.new(0, 0, -6); -- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
            };
            Stunned = {
                Start = "rbxassetid://128923537868786";
                Loop = "rbxassetid://122580527125278";
                End = "rbxassetid://99164529472582";
            };
        };
    },
    -- Jason –∏ JohnDoe –ø–æ–∫–∞ –ø—É—Å—Ç—ã–µ, –∫–∞–∫ –≤—ã –∏ –ø—Ä–æ—Å–∏–ª–∏
    ["Jason"] = { Animations = {} },
    ["JohnDoe"] = { Animations = {} },
}


-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
local activeEmotes: {[Humanoid]: {animationTrack: AnimationTrack?, sound: Sound?, stoppedConnection: RBXScriptConnection?}} = {}
local isMovementDisabled: boolean = false
local currentCategory = "Emotes" -- –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
local currentSubCategory = nil -- –¢–µ–∫—É—â–∞—è –≤—ã–±—Ä–∞–Ω–Ω–∞—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤–Ω—É—Ç—Ä–∏ "Animations"

-- –•—Ä–∞–Ω–∏—Ç –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –∫–Ω–æ–ø–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
local categoryData = {
    Emotes = {
        folder = emotesFolder,
        configs = {},
        buttons = {},
        scrollingFrame = nil,
        uiListLayout = nil,
        buttonNameCache = {}
    },
    Animations = {
        folder = nil, -- –ë–æ–ª—å—à–µ –Ω–µ —Å–∫–∞–Ω–∏—Ä—É–µ–º –ø–∞–ø–∫—É, –¥–∞–Ω–Ω—ã–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ä—É—é—Ç—Å—è
        subCategories = {}, -- –¢–µ–ø–µ—Ä—å –∑–¥–µ—Å—å –±—É–¥—É—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ allKillerAnimations
        buttons = {},
        scrollingFrame = nil,
        uiListLayout = nil,
        buttonNameCache = {},
        currentSubCategoryFrame = nil,
        currentSubCategoryLayout = nil,
    },
}

-- GUI Creation
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "EmoteGui"
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false

local openButton = Instance.new("TextButton")
openButton.Name = "OpenButton"
openButton.Parent = screenGui
openButton.Size = UDim2.new(0, 150, 0, 50)
openButton.Position = UDim2.new(0.5, -75, 0.8, 0)
openButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
openButton.BorderColor3 = Color3.fromRGB(255, 255, 255)
openButton.TextColor3 = Color3.fromRGB(255, 255, 255)
openButton.Text = "Open Menu"
openButton.Font = Enum.Font.SourceSansBold
openButton.TextSize = 20
openButton.Active = true
openButton.Draggable = true

local mainFrame = Instance.new("Frame")
mainFrame.Name = "EmoteMenu"
mainFrame.Parent = screenGui
mainFrame.Size = UDim2.new(0, 400, 0, 350)
mainFrame.Position = UDim2.new(0.5, -200, 0.5, -175)
mainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
mainFrame.BorderColor3 = Color3.fromRGB(255, 255, 255)
mainFrame.Visible = false
mainFrame.Active = true
mainFrame.Draggable = true

-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–Ω–æ–ø–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
local categoryButtonsFrame = Instance.new("Frame")
categoryButtonsFrame.Name = "CategoryButtons"
categoryButtonsFrame.Parent = mainFrame
categoryButtonsFrame.Size = UDim2.new(1, 0, 0, 40)
categoryButtonsFrame.Position = UDim2.new(0, 0, 0, 0)
categoryButtonsFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
categoryButtonsFrame.BorderSizePixel = 0

local uiListLayoutCategories = Instance.new("UIListLayout")
uiListLayoutCategories.Parent = categoryButtonsFrame
uiListLayoutCategories.FillDirection = Enum.FillDirection.Horizontal
uiListLayoutCategories.HorizontalAlignment = Enum.HorizontalAlignment.Center
uiListLayoutCategories.VerticalAlignment = Enum.VerticalAlignment.Center
uiListLayoutCategories.Padding = UDim.new(0, 5)
uiListLayoutCategories.SortOrder = Enum.SortOrder.LayoutOrder

-- –≠–ª–µ–º–µ–Ω—Ç—ã –ø–æ–∏—Å–∫–∞
local searchButton = Instance.new("TextButton")
searchButton.Name = "SearchButton"
searchButton.Parent = mainFrame
searchButton.Size = UDim2.new(0, 30, 0, 30)
searchButton.Position = UDim2.new(1, -35, 0, 45)
searchButton.BackgroundColor3 = Color3.fromRGB(55, 55, 55)
searchButton.BorderColor3 = Color3.fromRGB(255, 255, 255)
searchButton.TextColor3 = Color3.fromRGB(255, 255, 255)
searchButton.Text = "üîç"
searchButton.Font = Enum.Font.SourceSansBold
searchButton.TextSize = 20
searchButton.ZIndex = 2

local searchTextBox = Instance.new("TextBox")
searchTextBox.Name = "SearchTextBox"
searchTextBox.Parent = mainFrame
searchTextBox.Size = UDim2.new(1, -40, 0, 30)
searchTextBox.Position = UDim2.new(0, 5, 0, 85)
searchTextBox.PlaceholderText = "Search in the current category..."
searchTextBox.TextScaled = true
searchTextBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
searchTextBox.BorderColor3 = Color3.fromRGB(255, 255, 255)
searchTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
searchTextBox.Visible = false
searchTextBox.ClearTextOnFocus = false
searchTextBox.ZIndex = 2

--- –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ---

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ –¥–≤–∏–∂–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
local function resetPlayerMovement()
    if humanoid and isMovementDisabled then
        humanoid.WalkSpeed = 16
        humanoid.JumpPower = originalJumpPower
        isMovementDisabled = false
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —ç–º–æ—Ü–∏–∏ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –≥—É–º–∞–Ω–æ–∏–¥–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ —Å–µ–π—á–∞—Å)
local function stopEmoteForHumanoid(targetHumanoid: Humanoid)
    local emoteData = activeEmotes[targetHumanoid]
    if emoteData then
        if emoteData.animationTrack then
            emoteData.animationTrack:Stop()
            if emoteData.stoppedConnection then
                emoteData.stoppedConnection:Disconnect()
                emoteData.stoppedConnection = nil
            end
        end
        if emoteData.sound then
            emoteData.sound:Stop()
            emoteData.sound:Destroy() -- –£–¥–∞–ª—è–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∑–≤—É–∫–∞
        end
        activeEmotes[targetHumanoid] = nil
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã—Ö –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —ç–º–æ—Ü–∏–π –∏ —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä–æ–∫–∞
local function stopAllEmotes()
    if humanoid then
        stopEmoteForHumanoid(humanoid)
    end
    activeEmotes = {}
    resetPlayerMovement()
end

-- –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏)
-- –í–∫–ª—é—á–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥–ª—è —Ç–∞–±–ª–∏—Ü AssetID (—Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä) –∏ SFX
local function playLocalAnimation(targetHumanoid: Humanoid, animationIdOrTable: any, sfxIdOrTable: any, sfxProperties: {Looped: boolean?}, characterModel: Model)
    stopEmoteForHumanoid(targetHumanoid)

    local animationIdToPlay: string
    if type(animationIdOrTable) == "table" then
        if #animationIdOrTable > 0 then
            animationIdToPlay = animationIdOrTable[math.random(1, #animationIdOrTable)]
            print("DEBUG: –°–ª—É—á–∞–π–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–π AnimationId (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã):", animationIdToPlay)
        else
            warn("DEBUG: animationIdOrTable —è–≤–ª—è–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ–π. –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏—é.")
            return
        end
    elseif type(animationIdOrTable) == "string" then
        animationIdToPlay = animationIdOrTable
        print("DEBUG: –ò—Å–ø–æ–ª—å–∑—É–µ–º AnimationId (–∏–∑ —Å—Ç—Ä–æ–∫–∏):", animationIdToPlay)
    else
        warn("DEBUG: –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π —Ç–∏–ø –¥–ª—è animationIdOrTable. –û–∂–∏–¥–∞–ª–∞—Å—å —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–∞, –ø–æ–ª—É—á–µ–Ω–æ", type(animationIdOrTable))
        return
    end

    local animation = Instance.new("Animation")
    animation.AnimationId = animationIdToPlay
    local animationTrack = targetHumanoid:LoadAnimation(animation)
    animationTrack:Play()

    activeEmotes[targetHumanoid] = {animationTrack = animationTrack}

    local soundAttachmentPart = nil
    if sfxIdOrTable and characterModel then
        print("DEBUG: –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ —á–∞—Å—Ç—å –¥–ª—è –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∑–≤—É–∫–∞ –¥–ª—è characterModel:", characterModel.Name)

        local chosenSfxId: string
        if type(sfxIdOrTable) == "table" then
            if #sfxIdOrTable > 0 then
                chosenSfxId = sfxIdOrTable[math.random(1, #sfxIdOrTable)]
                print("DEBUG: –°–ª—É—á–∞–π–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–π SFXId (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã):", chosenSfxId)
            else
                warn("DEBUG: sfxIdOrTable —è–≤–ª—è–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ–π. –ó–≤—É–∫ –Ω–µ –±—É–¥–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è.")
            end
        elseif type(sfxIdOrTable) == "string" then
            chosenSfxId = sfxIdOrTable
            print("DEBUG: –ò—Å–ø–æ–ª—å–∑—É–µ–º SFXId (–∏–∑ —Å—Ç—Ä–æ–∫–∏):", chosenSfxId)
        else
            warn("DEBUG: –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π —Ç–∏–ø –¥–ª—è sfxIdOrTable. –û–∂–∏–¥–∞–ª–∞—Å—å —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–∞, –ø–æ–ª—É—á–µ–Ω–æ", type(sfxIdOrTable))
        end

        if chosenSfxId then
            local success, rootPartResult = pcall(function()
                return characterModel:WaitForChild("HumanoidRootPart", 10)
            end)

            if success and rootPartResult then
                soundAttachmentPart = rootPartResult
                print("DEBUG: HumanoidRootPart —É—Å–ø–µ—à–Ω–æ –Ω–∞–π–¥–µ–Ω–∞ –¥–ª—è", characterModel.Name)
            else
                warn(string.format("DEBUG: HumanoidRootPart –ù–ï –Ω–∞–π–¥–µ–Ω–∞ –¥–ª—è –º–æ–¥–µ–ª–∏ '%s' –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥! –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É (UpperTorso/Torso).", characterModel.Name))
                soundAttachmentPart = characterModel:FindFirstChild("UpperTorso") or characterModel:FindFirstChild("Torso")
                if soundAttachmentPart then
                    print(string.format("DEBUG: –£—Å–ø–µ—à–Ω–æ –Ω–∞–π–¥–µ–Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —á–∞—Å—Ç—å –¥–ª—è –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∑–≤—É–∫–∞ (%s) –¥–ª—è %s.", soundAttachmentPart.Name, characterModel.Name))
                else
                    warn(string.format("DEBUG: –ù–∏ HumanoidRootPart, –Ω–∏ UpperTorso, –Ω–∏ Torso –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥–ª—è –º–æ–¥–µ–ª–∏ '%s'! –ó–≤—É–∫ –Ω–µ –±—É–¥–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è.", characterModel.Name))
                end
            end
        end

        if chosenSfxId and soundAttachmentPart then
            local sound = Instance.new("Sound")
            sound.SoundId = chosenSfxId
            sound.Parent = soundAttachmentPart
            if sfxProperties and sfxProperties.Looped then
                sound.Looped = true
                local soundStoppedConnection
                soundStoppedConnection = animationTrack.Stopped:Connect(function()
                    if sound and sound.IsPlaying then
                        sound:Stop()
                    end
                    if soundStoppedConnection then
                        soundStoppedConnection:Disconnect()
                    end
                end)
            end
            sound:Play()
            activeEmotes[targetHumanoid].sound = sound
        elseif chosenSfxId then
            warn(string.format("DEBUG: –ó–≤—É–∫ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ '%s' –Ω–µ –º–æ–≥ –±—ã—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –¥–æ–ø—É—Å—Ç–∏–º–∞—è —á–∞—Å—Ç—å –¥–ª—è –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è.", animationIdToPlay))
        end
    elseif sfxIdOrTable and not characterModel then
        warn("DEBUG: characterModel = NIL –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏:", animationIdToPlay)
    end

    activeEmotes[targetHumanoid].stoppedConnection = animationTrack.Stopped:Connect(function()
        task.wait()
        if activeEmotes[targetHumanoid] and activeEmotes[targetHumanoid].animationTrack == animationTrack then
            stopEmoteForHumanoid(targetHumanoid)
        end
    end)
end


-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ö–æ–ª—Å—Ç–∞ ScrollingFrame –¥–ª—è –¥–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
local function updateCanvasSize(targetFrame: ScrollingFrame, targetLayout: UIListLayout)
    if not targetFrame or not targetLayout then return end

    task.wait(0.1) -- –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, —á—Ç–æ–±—ã UIListLayout —É—Å–ø–µ–ª –æ–±–Ω–æ–≤–∏—Ç—å—Å—è
    local contentSize = targetLayout.AbsoluteContentSize
    targetFrame.CanvasSize = UDim2.new(0, 0, 0, contentSize.Y + 10)
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–Ω–æ–ø–æ–∫ —ç–º–æ—Ü–∏–π/–∞–Ω–∏–º–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–∞ –ø–æ–∏—Å–∫–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–π –∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏
local function filterButtons(searchText: string)
    local lowerSearchText = searchText:lower()
    local targetButtons = nil
    local targetScrollingFrame = nil
    local targetUIListLayout = nil

    if currentCategory == "Emotes" then
        targetButtons = categoryData.Emotes.buttons
        targetScrollingFrame = categoryData.Emotes.scrollingFrame
        targetUIListLayout = categoryData.Emotes.uiListLayout
    elseif currentCategory == "Animations" then
        if currentSubCategory then
            -- –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Ñ–∏–ª—å—Ç—Ä—É–µ–º –µ–µ –∫–Ω–æ–ø–∫–∏
            targetButtons = categoryData.Animations.subCategories[currentSubCategory].buttons
            targetScrollingFrame = categoryData.Animations.currentSubCategoryFrame
            targetUIListLayout = categoryData.Animations.currentSubCategoryLayout
        else
            -- –ï—Å–ª–∏ –Ω–µ—Ç –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ñ–∏–ª—å—Ç—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π
            targetButtons = categoryData.Animations.buttons
            targetScrollingFrame = categoryData.Animations.scrollingFrame
            targetUIListLayout = categoryData.Animations.uiListLayout
        end
    end

    if not targetButtons then return end

    for name, button in pairs(targetButtons) do
        local buttonText = button.Text:lower()
        if string.find(buttonText, lowerSearchText) then
            button.Visible = true
        else
            button.Visible = false
        end
    end

    if targetScrollingFrame and targetUIListLayout then
        updateCanvasSize(targetScrollingFrame, targetUIListLayout)
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –¥–∞–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è "–∫–∞–º–µ—Ä–æ–π"
local function isCameraAnimation(animData: any)
    if type(animData) ~= "table" then return false end
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –∫–ª—é—á–∏, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ –Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—é –∫–∞–º–µ—Ä—ã.
    -- –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å CameraRig –∏–ª–∏ Camera, –∏–ª–∏ KillerRig + CameraRig.
    if animData.CameraRig or animData.Camera then return true end
    -- –ï—Å–ª–∏ —ç—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —Å KillerRig, –Ω–æ –±–µ–∑ PlayerRig, —ç—Ç–æ —á–∞—Å—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–∞—Ç—Å—Ü–µ–Ω–∞–º/–∫–∞–º–µ—Ä–µ
    if animData.KillerRig and not animData.PlayerRig then return true end
    -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –µ—Å–ª–∏ –µ—Å—Ç—å PlayerCFrameOffset, —ç—Ç–æ —Ç–æ–∂–µ –Ω–µ –ø—Ä—è–º–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∏–≥—Ä–æ–∫–∞
    if animData.PlayerCFrameOffset then return true end

    return false
end

-- –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –∞–Ω–∏–º–∞—Ü–∏–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö
-- –í —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∏–º—è "–∫–∏–ª–ª–µ—Ä–∞" (–Ω–∞–ø—Ä–∏–º–µ—Ä, "1x1x1x1")
local function createAnimationButtonsRecursive(parentFrame: ScrollingFrame, parentLayout: UIListLayout, animationTable: table, killerName: string)
    for animName, animValue in pairs(animationTable) do
        -- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è –∏–∑ –≤–∞—à–∏—Ö –º–æ–¥—É–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è AssetID
        if animName == "IntroLighting" or animName == "OutroLighting" or animName == "IntroSky" then
            continue
        end

        if type(animValue) == "string" and string.find(animValue, "rbxassetid://") then
            -- –≠—Ç–æ –ø—Ä—è–º–∞—è –∞–Ω–∏–º–∞—Ü–∏—è (AssetID)
            local button = Instance.new("TextButton")
            button.Name = animName .. "Button"
            button.Parent = parentFrame
            button.Size = UDim2.new(1, -10, 0, 40)
            button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
            button.BorderColor3 = Color3.fromRGB(255, 255, 255)
            button.TextColor3 = Color3.fromRGB(255, 255, 255)
            button.Text = animName -- –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–º—è –∞–Ω–∏–º–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Idle", "Walk")
            button.Font = Enum.Font.SourceSansBold
            button.TextSize = 18

            button.MouseButton1Click:Connect(function()
                if humanoid and character then
                    -- –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∞–Ω–∏–º–∞—Ü–∏—é. –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –Ω–µ—Ç SFX –∏–ª–∏ SFXProperties –¥–ª—è —ç—Ç–∏—Ö.
                    playLocalAnimation(humanoid, animValue, nil, nil, character)
                else
                    warn("DEBUG: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏—é, –≥—É–º–∞–Ω–æ–∏–¥ –∏–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂ —Ä–∞–≤–µ–Ω nil.")
                end
            end)
            -- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤ –∫—ç—à –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
            table.insert(categoryData.Animations.subCategories[killerName].buttons, button)
        elseif type(animValue) == "table" and not isCameraAnimation(animValue) then
            -- –≠—Ç–æ –≤–ª–æ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –∏ —ç—Ç–æ –ù–ï –∞–Ω–∏–º–∞—Ü–∏—è –∫–∞–º–µ—Ä—ã. –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –Ω–µ–µ.
            -- –ú—ã –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Å–∞–º–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Stunned"),
            -- –∞ —Å–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –µ–µ –¥–æ—á–µ—Ä–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ("Start", "Loop", "End").
            createAnimationButtonsRecursive(parentFrame, parentLayout, animValue, killerName)
        end
    end
end


-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (Emotes, Animations)
local function createCategoryButtons(categoryName: string, folder: Folder?)
    local currentCategoryData = categoryData[categoryName]
    if not currentCategoryData then return end

    -- –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ –∏ –∫—ç—à–∏ –¥–ª—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    for _, button in pairs(currentCategoryData.buttons) do
        button:Destroy()
    end
    currentCategoryData.buttons = {}
    currentCategoryData.configs = {}
    currentCategoryData.buttonNameCache = {}

    if categoryName == "Emotes" then
        if not folder then
            warn("DEBUG: Emotes folder is nil. Skipping emote button creation.")
            return
        end
        for _, emoteConfigModule in pairs(folder:GetChildren()) do
            if emoteConfigModule:IsA("ModuleScript") then
                local success, emoteData = pcall(require, emoteConfigModule)
                if success and emoteData.AssetID then
                    local buttonText = emoteData.DisplayName or (type(emoteData.AssetID) == "string" and emoteData.AssetID or "–≠–º–æ—Ü–∏—è")

                    if currentCategoryData.buttonNameCache[buttonText] then
                        warn(string.format("DEBUG: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è –∫–Ω–æ–ø–∫–∞ —ç–º–æ—Ü–∏–∏ '%s' –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ '%s'. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –µ–µ.", buttonText, categoryName))
                        continue
                    end

                    currentCategoryData.buttonNameCache[buttonText] = true

                    local button = Instance.new("TextButton")
                    button.Name = emoteConfigModule.Name .. "Button"
                    button.Parent = currentCategoryData.scrollingFrame
                    button.Size = UDim2.new(1, -10, 0, 40)
                    button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                    button.BorderColor3 = Color3.fromRGB(255, 255, 255)
                    button.TextColor3 = Color3.fromRGB(255, 255, 255)
                    button.Text = buttonText
                    button.Font = Enum.Font.SourceSansBold
                    button.TextSize = 18

                    button.MouseButton1Click:Connect(function()
                        if humanoid and character then
                            playLocalAnimation(humanoid, emoteData.AssetID, emoteData.SFX, emoteData.SFXProperties, character)
                        else
                            warn("DEBUG: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —ç–º–æ—Ü–∏—é, –≥—É–º–∞–Ω–æ–∏–¥ –∏–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂ —Ä–∞–≤–µ–Ω nil.")
                        end
                    end)

                    currentCategoryData.buttons[buttonText] = button
                    table.insert(currentCategoryData.configs, emoteData)
                else
                    warn("DEBUG: –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª—å —ç–º–æ—Ü–∏–∏ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç AssetID –≤ –ø–∞–ø–∫–µ '%s':", categoryName, emoteConfigModule.Name)
                end
            end
        end
        updateCanvasSize(currentCategoryData.scrollingFrame, currentCategoryData.uiListLayout)

    elseif categoryName == "Animations" then
        -- –î–ª—è "Animations" –º—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ allKillerAnimations
        for killerName, killerData in pairs(allKillerAnimations) do
            -- –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —ç—Ç–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "1x1x1x1")
            currentCategoryData.subCategories[killerName] = {
                data = killerData, -- –•—Ä–∞–Ω–∏—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                buttons = {}, -- –ë—É–¥—É—Ç –∫–Ω–æ–ø–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–π –¥–ª—è —ç—Ç–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                scrollingFrame = nil,
                uiListLayout = nil,
                buttonNameCache = {}
            }

            -- –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É –¥–ª—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "1x1x1x1")
            local subCategoryButton = Instance.new("TextButton")
            subCategoryButton.Name = killerName .. "SubCategoryButton"
            subCategoryButton.Parent = currentCategoryData.scrollingFrame
            subCategoryButton.Size = UDim2.new(1, -10, 0, 40)
            subCategoryButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
            subCategoryButton.BorderColor3 = Color3.fromRGB(255, 255, 255)
            subCategoryButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            subCategoryButton.Text = killerName
            subCategoryButton.Font = Enum.Font.SourceSansBold
            subCategoryButton.TextSize = 18
            currentCategoryData.buttons[killerName] = subCategoryButton

            subCategoryButton.MouseButton1Click:Connect(function()
                -- –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π ScrollingFrame "Animations"
                currentCategoryData.scrollingFrame.Visible = false
                currentSubCategory = killerName

                -- –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º ScrollingFrame –¥–ª—è —ç—Ç–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                local subCatFrame = currentCategoryData.subCategories[killerName].scrollingFrame
                local subCatLayout = currentCategoryData.subCategories[killerName].uiListLayout

                if not subCatFrame then
                    subCatFrame = Instance.new("ScrollingFrame")
                    subCatFrame.Name = killerName .. "AnimationsContainer"
                    subCatFrame.Parent = mainFrame
                    subCatFrame.Size = UDim2.new(1, 0, 1, -80)
                    subCatFrame.Position = UDim2.new(0, 0, 0, 80)
                    subCatFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
                    subCatFrame.BorderSizePixel = 0
                    subCatFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
                    subCatFrame.ScrollBarImageColor3 = Color3.fromRGB(255, 255, 255)
                    subCatFrame.Visible = true

                    subCatLayout = Instance.new("UIListLayout")
                    subCatLayout.Parent = subCatFrame
                    subCatLayout.Padding = UDim.new(0, 5)
                    subCatLayout.SortOrder = Enum.SortOrder.LayoutOrder

                    currentCategoryData.subCategories[killerName].scrollingFrame = subCatFrame
                    currentCategoryData.subCategories[killerName].uiListLayout = subCatLayout

                    -- –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
                    if killerData.ZombieAnimations then
                        createAnimationButtonsRecursive(subCatFrame, subCatLayout, killerData.ZombieAnimations, killerName)
                    end
                    if killerData.Animations then
                        createAnimationButtonsRecursive(subCatFrame, subCatLayout, killerData.Animations, killerName)
                    end
                    if killerData.PizzaDeliveryAnimations then
                        createAnimationButtonsRecursive(subCatFrame, subCatLayout, killerData.PizzaDeliveryAnimations, killerName)
                    end
                    if killerData.VoidRush then
                        createAnimationButtonsRecursive(subCatFrame, subCatLayout, killerData.VoidRush, killerName)
                    end
                    for k, v in pairs(killerData) do
                        if type(v) == "string" and string.find(v, "rbxassetid://") and not isCameraAnimation(v) then
                             -- –°–æ–∑–¥–∞—Ç—å –∫–Ω–æ–ø–∫—É –¥–ª—è —ç—Ç–æ–π top-level –∞–Ω–∏–º–∞—Ü–∏–∏
                            local button = Instance.new("TextButton")
                            button.Name = k .. "Button"
                            button.Parent = subCatFrame
                            button.Size = UDim2.new(1, -10, 0, 40)
                            button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                            button.BorderColor3 = Color3.fromRGB(255, 255, 255)
                            button.TextColor3 = Color3.fromRGB(255, 255, 255)
                            button.Text = k
                            button.Font = Enum.Font.SourceSansBold
                            button.TextSize = 18
                            button.MouseButton1Click:Connect(function()
                                if humanoid and character then
                                    playLocalAnimation(humanoid, v, nil, nil, character)
                                else
                                    warn("DEBUG: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏—é, –≥—É–º–∞–Ω–æ–∏–¥ –∏–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂ —Ä–∞–≤–µ–Ω nil.")
                                end
                            end)
                            table.insert(currentCategoryData.subCategories[killerName].buttons, button)
                        end
                    end


                else
                    subCatFrame.Visible = true
                end

                currentCategoryData.currentSubCategoryFrame = subCatFrame
                currentCategoryData.currentSubCategoryLayout = subCatLayout

                -- –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä —Ö–æ–ª—Å—Ç–∞ –¥–ª—è –Ω–æ–≤–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                updateCanvasSize(subCatFrame, subCatLayout)
                searchTextBox.Text = "" -- –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∏—Å–∫ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                filterButtons("")
            end)
        end
        updateCanvasSize(currentCategoryData.scrollingFrame, currentCategoryData.uiListLayout)
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–∑ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫ —Å–ø–∏—Å–∫—É –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π
local function backToSubCategories()
    local animData = categoryData.Animations
    if animData.currentSubCategoryFrame then
        animData.currentSubCategoryFrame.Visible = false
        animData.currentSubCategoryFrame = nil
        animData.currentSubCategoryLayout = nil
    end
    currentSubCategory = nil
    animData.scrollingFrame.Visible = true -- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π
    searchTextBox.Text = ""
    filterButtons("")
    updateCanvasSize(animData.scrollingFrame, animData.uiListLayout)
end

-- –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –¥–ª—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π
local backButton = Instance.new("TextButton")
backButton.Name = "BackButton"
backButton.Parent = mainFrame
backButton.Size = UDim2.new(0, 60, 0, 30)
backButton.Position = UDim2.new(0, 5, 0, 45) -- –°–ª–µ–≤–∞ –æ—Ç –ø–æ–∏—Å–∫–∞
backButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
backButton.BorderColor3 = Color3.fromRGB(255, 255, 255)
backButton.TextColor3 = Color3.fromRGB(255, 255, 255)
backButton.Text = "‚Üê Back"
backButton.Font = Enum.Font.SourceSansBold
backButton.TextSize = 14
backButton.ZIndex = 2
backButton.Visible = false -- –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç

backButton.MouseButton1Click:Connect(backToSubCategories)


-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
local function switchToCategory(newCategoryName: string)
    if currentCategory == newCategoryName and not currentSubCategory then return end

    -- –°–∫—Ä—ã–≤–∞–µ–º ScrollingFrame –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    local prevCategoryData = categoryData[currentCategory]
    if prevCategoryData and prevCategoryData.scrollingFrame then
        prevCategoryData.scrollingFrame.Visible = false
    end
    -- –ï—Å–ª–∏ –±—ã–ª–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Å–∫—Ä—ã–≤–∞–µ–º –µ—ë
    if prevCategoryData and prevCategoryData.currentSubCategoryFrame then
        prevCategoryData.currentSubCategoryFrame.Visible = false
        prevCategoryData.currentSubCategoryFrame = nil
        prevCategoryData.currentSubCategoryLayout = nil
    end
    currentSubCategory = nil -- –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø—Ä–∏ —Å–º–µ–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

    -- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º ScrollingFrame –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    local newCategoryData = categoryData[newCategoryName]
    if newCategoryData and newCategoryData.scrollingFrame then
        newCategoryData.scrollingFrame.Visible = true
        currentCategory = newCategoryName

        -- –£–ø—Ä–∞–≤–ª—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
        backButton.Visible = (newCategoryName == "Animations")

        -- –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        searchTextBox.Text = ""
        filterButtons("")

        print("DEBUG: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:", newCategoryName)
    else
        warn("DEBUG: –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–ª–∏ –Ω–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é:", newCategoryName)
    end
end


--- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GUI –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ---

-- –°–æ–∑–¥–∞–µ–º ScrollingFrame –∏ UIListLayout –¥–ª—è –∫–∞–∂–¥–æ–π –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
for catName, catData in pairs(categoryData) do
    local scrollingFrame = Instance.new("ScrollingFrame")
    scrollingFrame.Name = catName .. "Container"
    scrollingFrame.Parent = mainFrame
    scrollingFrame.Size = UDim2.new(1, 0, 1, -80) -- –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π + –ø–æ–∏—Å–∫–∞
    scrollingFrame.Position = UDim2.new(0, 0, 0, 80) -- –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
    scrollingFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    scrollingFrame.BorderSizePixel = 0
    scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    scrollingFrame.ScrollBarImageColor3 = Color3.fromRGB(255, 255, 255)
    scrollingFrame.Visible = false -- –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç

    local uiListLayout = Instance.new("UIListLayout")
    uiListLayout.Parent = scrollingFrame
    uiListLayout.Padding = UDim.new(0, 5)
    uiListLayout.SortOrder = Enum.SortOrder.LayoutOrder

    catData.scrollingFrame = scrollingFrame
    catData.uiListLayout = uiListLayout
end

-- –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
local categoryButtonNames = {"Emotes", "Animations"}
for i, catName in ipairs(categoryButtonNames) do
    local button = Instance.new("TextButton")
    button.Name = catName .. "Tab"
    button.Parent = categoryButtonsFrame
    button.Size = UDim2.new(1/#categoryButtonNames, -5, 1, -10) -- –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ —Å –Ω–µ–±–æ–ª—å—à–∏–º –æ—Ç—Å—Ç—É–ø–æ–º
    button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    button.BorderColor3 = Color3.fromRGB(255, 255, 255)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Text = catName
    button.Font = Enum.Font.SourceSansBold
    button.TextSize = 18
    button.LayoutOrder = i -- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º –ø–æ—Ä—è–¥–æ–∫ —Å UIListLayout

    button.MouseButton1Click:Connect(function()
        switchToCategory(catName)
    end)
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–∫–µ—Ç–∞
local function toggleSearchBar()
    local isVisible = searchTextBox.Visible
    searchTextBox.Visible = not isVisible

    local targetSf = nil
    local targetLayout = nil

    if currentCategory == "Emotes" then
        targetSf = categoryData.Emotes.scrollingFrame
        targetLayout = categoryData.Emotes.uiListLayout
    elseif currentCategory == "Animations" then
        if currentSubCategory then
            targetSf = categoryData.Animations.currentSubCategoryFrame
            targetLayout = categoryData.Animations.currentSubCategoryLayout
        else
            targetSf = categoryData.Animations.scrollingFrame
            targetLayout = categoryData.Animations.uiListLayout
        end
    end

    if not targetSf then return end

    if searchTextBox.Visible then
        searchTextBox:CaptureFocus()
        targetSf.Position = UDim2.new(0, 0, 0, 115) -- –ü–µ—Ä–µ–º–µ—â–∞–µ–º ScrollingFrame –Ω–∏–∂–µ –¥–ª—è –ø–æ–∏—Å–∫–∞
        targetSf.Size = UDim2.new(1, 0, 1, -115) -- –£–º–µ–Ω—å—à–∞–µ–º –≤—ã—Å–æ—Ç—É
        searchTextBox.Text = ""
        filterButtons("")
    else
        searchTextBox:ReleaseFocus()
        targetSf.Position = UDim2.new(0, 0, 0, 80) -- –ü–µ—Ä–µ–º–µ—â–∞–µ–º ScrollingFrame –æ–±—Ä–∞—Ç–Ω–æ
        targetSf.Size = UDim2.new(1, 0, 1, -80) -- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É
        filterButtons("")
    end
    updateCanvasSize(targetSf, targetLayout)
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –º–µ–Ω—é —ç–º–æ—Ü–∏–π
local function toggleMenu()
    mainFrame.Visible = not mainFrame.Visible
    openButton.Text = mainFrame.Visible and "Close Menu" or "Open Menu"
    if mainFrame.Visible then
        -- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–µ–Ω—é —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –ø–æ–∫–∞–∑–∞–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        switchToCategory("Emotes") -- –ò–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    else
        -- –ï—Å–ª–∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é, —Ç–∞–∫–∂–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ–∏—Å–∫–∞
        if searchTextBox.Visible then
            toggleSearchBar()
        end
        -- –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥", –µ—Å–ª–∏ –º–µ–Ω—é –∑–∞–∫—Ä—ã—Ç–æ
        backButton.Visible = false
    end
end

-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–∫—Ä—ã—Ç–∏—è
openButton.MouseButton1Click:Connect(toggleMenu)

-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–∏—Å–∫–∞
searchButton.MouseButton1Click:Connect(toggleSearchBar)

-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–æ–±—ã—Ç–∏–µ .Changed —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è –ø–æ–∏—Å–∫–∞
searchTextBox.Changed:Connect(function(property)
    if property == "Text" then
        filterButtons(searchTextBox.Text)
    end
end)

-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–æ–±—ã—Ç–∏–µ .FocusLost —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è –ø–æ–∏—Å–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Enter –∏–ª–∏ –∫–ª–∏–∫–µ –≤ —Å—Ç–æ—Ä–æ–Ω—É)
searchTextBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        filterButtons(searchTextBox.Text)
    end
end)

-- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏–≥—Ä–æ–∫–∞
local function setupHumanoidConnections(targetHumanoid: Humanoid)
end

local function handleCharacterSetup(newCharacter: Model)
    print("DEBUG: –ü–µ—Ä—Å–æ–Ω–∞–∂ –∑–∞–≥—Ä—É–∂–µ–Ω:", newCharacter.Name)
    local success, newHumanoid = pcall(function()
        return newCharacter:WaitForChild("Humanoid", 10)
    end)
    if success and newHumanoid then
        humanoid = newHumanoid
        originalJumpPower = humanoid.JumpPower or 50
        print("DEBUG: –ì—É–º–∞–Ω–æ–∏–¥ –∏–≥—Ä–æ–∫–∞ –Ω–∞–π–¥–µ–Ω –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:", humanoid.Name)
        setupHumanoidConnections(humanoid)
        stopAllEmotes()
    else
        humanoid = nil
        warn("DEBUG: –ì—É–º–∞–Ω–æ–∏–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:", newCharacter.Name, "–ø–æ—Å–ª–µ 10 —Å–µ–∫—É–Ω–¥.")
    end
end

-- –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
player.CharacterAdded:Connect(function(char)
    character = char
    handleCharacterSetup(char)
end)

if player.Character then
    character = player.Character
    handleCharacterSetup(character)
end

-- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ —ç–º–æ—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ü—Ä–æ–±–µ–ª–∞ –∏ –æ—Ç–∫–ª—é—á–∞–µ–º –ø—Ä—ã–∂–æ–∫
UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if gameProcessedEvent then return end

    if input.KeyCode == Enum.KeyCode.Space then
        stopAllEmotes()

        if humanoid then
            originalJumpPower = humanoid.JumpPower or 50
            humanoid.JumpPower = 0
            humanoid.Jump = false
        end
    elseif input.UserInputType == Enum.UserInputType.Gamepad1 and input.KeyCode == Enum.KeyCode.ButtonA then
        stopAllEmotes()
    elseif input.UserInputType == Enum.UserInputType.Touch then
        stopAllEmotes()
    end
end)

UserInputService.InputEnded:Connect(function(input, gameProcessedEvent)
    if gameProcessedEvent then return end

    if input.KeyCode == Enum.KeyCode.Space then
        if humanoid then
            humanoid.JumpPower = originalJumpPower
        end
    end
end)

-- –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ —ç–º–æ—Ü–∏–π –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
-- Folder –¥–ª—è Emotes –ø–µ—Ä–µ–¥–∞–µ–º, –¥–ª—è Animations - nil, —Ç.–∫. –¥–∞–Ω–Ω—ã–µ –≤—Å—Ç—Ä–æ–µ–Ω—ã
createCategoryButtons("Emotes", emotesFolder)
createCategoryButtons("Animations", nil) -- –ü–µ—Ä–µ–¥–∞–µ–º nil, —Ç.–∫. –¥–∞–Ω–Ω—ã–µ —É–∂–µ –≤ —Å–∫—Ä–∏–ø—Ç–µ

-- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –≤–∏–¥–∏–º—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
switchToCategory("Emotes")

print("DEBUG: –°–∫—Ä–∏–ø—Ç —ç–º–æ—Ü–∏–π —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏.")
]]

-- === –û–ë–†–ê–ë–û–¢–ö–ê –ö–ù–û–ü–ö–ò –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –ö–õ–Æ–ß–ê ===
submitButton.MouseButton1Click:Connect(function()
	local inputKey = textBox.Text
	if inputKey == validKey then
		keyGui:Destroy()

		local success, err = pcall(function()
			loadstring(lexioiScript)()
		end)

		if not success then
			warn("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∫—Ä–∏–ø—Ç–∞ Lexioi: " .. tostring(err))
		end
	else
		textBox.Text = "Invalid key!"
	end
end)
